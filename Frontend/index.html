<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resume Analyzer Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/framer-motion/10.16.4/framer-motion.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#4361ee',
                        secondary: '#3f37c9',
                        dark: '#0a192f',
                        light: '#f0f7ff',
                        accent: '#4cc9f0',
                        success: '#4ade80',
                        warning: '#fbbf24',
                        error: '#f87171'
                    },
                    fontFamily: {
                        sans: ['Poppins', 'sans-serif']
                    }
                }
            }
        }
    </script>
    <style>
        :root {
            --primary: #4361ee;
            --secondary: #3f37c9;
            --dark: #0a192f;
            --light: #f0f7ff;
            --accent: #4cc9f0;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--light);
            color: #333;
            overflow-x: hidden;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #0a192f 0%, #1e3a8a 100%);
        }
        
        .card {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
        }
        
        .upload-area {
            border: 2px dashed #cbd5e1;
            border-radius: 15px;
            transition: all 0.3s ease;
            background: white;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
        }
        
        .upload-area:hover, .upload-area.drag-over {
            border-color: var(--primary);
            background: rgba(67, 97, 238, 0.05);
        }
        
        .progress-bar {
            height: 8px;
            border-radius: 4px;
            background: #e2e8f0;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            border-radius: 4px;
            transition: width 0.5s ease;
        }
        
        .skill-tag {
            display: inline-block;
            padding: 4px 12px;
            background: rgba(67, 97, 238, 0.1);
            border-radius: 20px;
            margin: 5px;
            font-size: 0.85rem;
            transition: all 0.2s;
        }
        
        .skill-tag.missing {
            background: rgba(248, 113, 113, 0.15);
        }
        
        .suggestion-item {
            padding: 15px;
            border-radius: 12px;
            background: white;
            margin-bottom: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }
        
        .suggestion-item:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .floating {
            animation: float 6s ease-in-out infinite;
        }
        
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
            100% { transform: translateY(0px); }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(67, 97, 238, 0.4); }
            70% { box-shadow: 0 0 0 15px rgba(67, 97, 238, 0); }
            100% { box-shadow: 0 0 0 0 rgba(67, 97, 238, 0); }
        }
        
        .fade-in {
            animation: fadeIn 0.8s ease-out forwards;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .wave {
            animation: wave 1.5s infinite;
        }
        
        @keyframes wave {
            0% { transform: rotate(0deg); }
            10% { transform: rotate(14deg); }
            20% { transform: rotate(-8deg); }
            30% { transform: rotate(14deg); }
            40% { transform: rotate(-4deg); }
            50% { transform: rotate(10deg); }
            60% { transform: rotate(0deg); }
            100% { transform: rotate(0deg); }
        }

        /* Mobile menu styles */
        .mobile-menu {
            transform: translateX(-100%);
            transition: transform 0.3s ease-in-out;
        }
        
        .mobile-menu.active {
            transform: translateX(0);
        }

        /* Responsive adjustments without changing original design */
        @media (max-width: 768px) {
            .upload-area {
                padding: 1.5rem;
            }
            
            /* Make text readable on mobile */
            h1.hero-title {
                font-size: 2.5rem;
                line-height: 1.2;
            }
        }

        @media (max-width: 640px) {
            h1.hero-title {
                font-size: 2rem;
                line-height: 1.3;
            }
        }
    </style>
</head>
<body class="bg-light">
    <nav class="gradient-bg text-white py-4 px-6 fixed w-full z-50">
        <div class="max-w-7xl mx-auto flex justify-between items-center">
            <div class="flex items-center space-x-2">
                <i class="fas fa-file-alt text-accent text-2xl"></i>
                <h1 class="text-2xl font-bold">Resume<span class="text-accent">Analyzer</span>Pro</h1>
            </div>
            <div class="hidden md:flex space-x-8">
                <a href="#features" class="hover:text-accent transition">Features</a>
                <a href="#how-it-works" class="hover:text-accent transition">How It Works</a>
                <a href="#analyzer" class="hover:text-accent transition">Analyze</a>
            </div>
            <button class="hidden md:block bg-accent hover:bg-primary text-white px-6 py-2 rounded-full font-medium transition">
                Get Started
            </button>
            <button class="md:hidden" id="mobileMenuBtn">
                <i class="fas fa-bars text-2xl"></i>
            </button>
        </div>
        
        <div class="mobile-menu fixed top-0 left-0 w-full h-full bg-dark z-40 pt-20 px-6 md:hidden" id="mobileMenu">
            <div class="space-y-6">
                <a href="#features" class="block text-xl hover:text-accent transition mobile-menu-link">Features</a>
                <a href="#how-it-works" class="block text-xl hover:text-accent transition mobile-menu-link">How It Works</a>
                <a href="#analyzer" class="block text-xl hover:text-accent transition mobile-menu-link">Analyze</a>
                <button class="bg-accent hover:bg-primary text-white px-8 py-3 rounded-full font-medium transition w-full mt-8">
                    Get Started
                </button>
            </div>
        </div>
    </nav>

    <section class="gradient-bg text-white pt-32 pb-20 px-6">
        <div class="max-w-7xl mx-auto grid md:grid-cols-2 gap-12 items-center">
            <div class="space-y-6">
                <h1 class="hero-title text-5xl md:text-6xl font-bold leading-tight">
                    Optimize Your Resume with <span class="text-accent">AI-Powered</span> Analysis
                </h1>
                <p class="text-xl text-gray-300 max-w-xl">
                    Get instant feedback on your resume's effectiveness and receive personalized suggestions to land your dream job.
                </p>
                <div class="flex flex-wrap gap-4 mt-8">
                    <a href="#analyzer" class="bg-accent hover:bg-primary text-white px-8 py-4 rounded-full font-medium text-lg transition transform hover:scale-105">
                        Analyze Now <i class="fas fa-arrow-right ml-2"></i>
                    </a>
                    <a href="#features" class="border-2 border-accent text-accent hover:bg-accent hover:text-white px-8 py-4 rounded-full font-medium text-lg transition">
                        Learn More
                    </a>
                </div>
            </div>
            <div class="relative flex justify-center">
                <div class="relative w-full max-w-md">
                    <div class="absolute -top-10 -left-10 w-64 h-64 bg-accent rounded-full opacity-20 blur-3xl"></div>
                    <div class="absolute -bottom-10 -right-10 w-72 h-72 bg-primary rounded-full opacity-20 blur-3xl"></div>
                    <div class="card p-8 relative z-10">
                        <div class="flex justify-between items-center mb-6">
                            <div>
                                <h3 class="font-bold text-xl text-gray-900">Resume Score</h3>
                                <p class="text-gray-700">Based on job description match</p>
                            </div>
                            <div class="relative">
                                <div class="w-20 h-20 rounded-full bg-gradient-to-br from-primary to-accent flex items-center justify-center">
                                    <span class="text-white text-2xl font-bold">87</span>
                                </div>
                                <div class="absolute -top-2 -right-2 bg-success text-white text-xs px-2 py-1 rounded-full">
                                    +12%
                                </div>
                            </div>
                        </div>
                        
                        <div class="space-y-4 text-gray-800">
                            <div>
                                <div class="flex justify-between mb-1">
                                    <span class="font-medium">Skills Match</span>
                                    <span>92%</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-3">
                                    <div class="bg-primary h-3 rounded-full" style="width: 92%;"></div>
                                </div>
                            </div>
                            
                            <div>
                                <div class="flex justify-between mb-1">
                                    <span class="font-medium">Experience Relevance</span>
                                    <span>78%</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-3">
                                    <div class="bg-primary h-3 rounded-full" style="width: 78%;"></div>
                                </div>
                            </div>
                            
                            <div>
                                <div class="flex justify-between mb-1">
                                    <span class="font-medium">Keyword Optimization</span>
                                    <span>85%</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-3">
                                    <div class="bg-primary h-3 rounded-full" style="width: 85%;"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-6 pt-6 border-t border-gray-200 text-gray-800">
                            <h4 class="font-bold mb-3">Top Suggestions</h4>
                            <ul class="space-y-2">
                                <li class="flex items-start">
                                    <i class="fas fa-check-circle text-success mt-1 mr-2"></i>
                                    <span>Add quantifiable achievements</span>
                                </li>
                                <li class="flex items-start">
                                    <i class="fas fa-check-circle text-success mt-1 mr-2"></i>
                                    <span>Include keyword "project management"</span>
                                </li>
                                <li class="flex items-start">
                                    <i class="fas fa-check-circle text-success mt-1 mr-2"></i>
                                    <span>Highlight leadership experience</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="features" class="py-20 px-6 bg-white">
        <div class="max-w-7xl mx-auto">
            <div class="text-center max-w-3xl mx-auto mb-16">
                <h2 class="text-4xl font-bold mb-4">Powerful Features for Your Career Success</h2>
                <p class="text-gray-600 text-lg">
                    Our AI-powered platform provides comprehensive resume analysis to help you stand out in the competitive job market.
                </p>
            </div>
            
            <div class="grid md:grid-cols-3 gap-8">
                <div class="card p-8 text-center">
                    <div class="w-20 h-20 rounded-full bg-blue-50 flex items-center justify-center mx-auto mb-6">
                        <i class="fas fa-file-pdf text-primary text-3xl"></i>
                    </div>
                    <h3 class="text-2xl font-bold mb-3">Resume Analysis</h3>
                    <p class="text-gray-600 mb-4">
                        Upload your resume in PDF format and get instant feedback on its effectiveness.
                    </p>
                    <div class="flex justify-center">
                        <div class="text-primary text-4xl">
                            <i class="fas fa-file-pdf"></i>
                        </div>
                    </div>
                </div>
                
                <div class="card p-8 text-center">
                    <div class="w-20 h-20 rounded-full bg-green-50 flex items-center justify-center mx-auto mb-6">
                        <i class="fas fa-file-alt text-success text-3xl"></i>
                    </div>
                    <h3 class="text-2xl font-bold mb-3">Job Description Matching</h3>
                    <p class="text-gray-600 mb-4">
                        Paste job description text to analyze how well your resume matches the requirements.
                    </p>
                    <div class="flex justify-center">
                        <div class="text-success text-4xl">
                            <i class="fas fa-clipboard-list"></i>
                        </div>
                    </div>
                </div>
                
                <div class="card p-8 text-center">
                    <div class="w-20 h-20 rounded-full bg-purple-50 flex items-center justify-center mx-auto mb-6">
                        <i class="fas fa-lightbulb text-purple-500 text-3xl"></i>
                    </div>
                    <h3 class="text-2xl font-bold mb-3">AI-Powered Suggestions</h3>
                    <p class="text-gray-600 mb-4">
                        Get actionable improvement suggestions powered by Google Gemini AI technology.
                    </p>
                    <div class="flex justify-center">
                        <div class="text-purple-500 text-4xl">
                            <i class="fas fa-robot"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="how-it-works" class="py-20 px-6 bg-light">
        <div class="max-w-7xl mx-auto">
            <div class="text-center max-w-3xl mx-auto mb-16">
                <h2 class="text-4xl font-bold mb-4">How Resume Analyzer Pro Works</h2>
                <p class="text-gray-600 text-lg">
                    Three simple steps to optimize your resume and increase your chances of landing interviews.
                </p>
            </div>
            
            <div class="grid md:grid-cols-3 gap-8">
                <div class="flex flex-col items-center text-center">
                    <div class="w-24 h-24 rounded-full bg-white flex items-center justify-center mb-6 border-4 border-primary relative">
                        <span class="text-primary text-4xl font-bold">1</span>
                        <div class="absolute -top-4 -right-4 w-10 h-10 bg-accent rounded-full flex items-center justify-center">
                            <i class="fas fa-file-pdf text-white"></i>
                        </div>
                    </div>
                    <h3 class="text-2xl font-bold mb-3">Upload Resume</h3>
                    <p class="text-gray-600">
                        Upload your resume in PDF format for analysis.
                    </p>
                    <div class="mt-4">
                        <div class="upload-area inline-block p-4">
                            <i class="fas fa-cloud-upload-alt text-primary text-3xl mb-2"></i>
                            <p class="text-sm">PDF Only</p>
                        </div>
                    </div>
                </div>
                
                <div class="flex flex-col items-center text-center">
                    <div class="w-24 h-24 rounded-full bg-white flex items-center justify-center mb-6 border-4 border-primary relative">
                        <span class="text-primary text-4xl font-bold">2</span>
                        <div class="absolute -top-4 -right-4 w-10 h-10 bg-accent rounded-full flex items-center justify-center">
                            <i class="fas fa-keyboard text-white"></i>
                        </div>
                    </div>
                    <h3 class="text-2xl font-bold mb-3">Job Description</h3>
                    <p class="text-gray-600">
                        Paste the job description text you're targeting.
                    </p>
                    <div class="mt-4 w-full max-w-xs">
                        <textarea 
                            placeholder="Paste job description..."
                            class="w-full p-4 border border-gray-300 rounded-lg min-h-[120px]"
                        ></textarea>
                    </div>
                </div>
                
                <div class="flex flex-col items-center text-center">
                    <div class="w-24 h-24 rounded-full bg-white flex items-center justify-center mb-6 border-4 border-primary relative">
                        <span class="text-primary text-4xl font-bold">3</span>
                        <div class="absolute -top-4 -right-4 w-10 h-10 bg-accent rounded-full flex items-center justify-center">
                            <i class="fas fa-robot text-white"></i>
                        </div>
                    </div>
                    <h3 class="text-2xl font-bold mb-3">Get Score & Suggestions</h3>
                    <p class="text-gray-600">
                        Receive instant analysis and improvement suggestions.
                    </p>
                    <div class="mt-4 flex gap-4">
                        <button class="bg-accent hover:bg-primary text-white px-6 py-3 rounded-full font-medium flex items-center">
                            <i class="fas fa-chart-line mr-2"></i> Score
                        </button>
                        <button class="bg-primary hover:bg-accent text-white px-6 py-3 rounded-full font-medium flex items-center">
                            <i class="fas fa-lightbulb mr-2"></i> Suggestions
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="analyzer" class="py-20 px-6 bg-white">
        <div class="max-w-5xl mx-auto">
            <div class="text-center mb-16">
                <h2 class="text-4xl font-bold mb-4">Analyze Your Resume</h2>
                <p class="text-gray-600 text-lg max-w-xl mx-auto">
                    Upload your resume and job description to get personalized feedback and improvement suggestions.
                </p>
            </div>
            
            <div class="card p-8">
                <div class="grid md:grid-cols-2 gap-8">
                    <div>
                        <h3 class="text-xl font-bold mb-4">Resume (PDF Only)</h3>
                        <div class="upload-area p-8 mb-4 relative" id="resumeUpload">
                            <div class="text-5xl text-primary mb-4">
                                <i class="fas fa-file-pdf"></i>
                            </div>
                            <p class="font-medium" id="resumeFilename">Drag & drop your PDF resume</p>
                            <p class="text-gray-500 text-sm mt-2">or click to browse files</p>
                            <input type="file" id="resumeInput" class="opacity-0 absolute inset-0 w-full h-full cursor-pointer" accept=".pdf">
                        </div>
                        <div class="flex items-center text-gray-500 text-sm">
                            <i class="fas fa-info-circle mr-2"></i>
                            <span>PDF files only, max 5MB</span>
                        </div>
                    </div>
                    
                    <div>
                        <h3 class="text-xl font-bold mb-4">Job Description</h3>
                        <p class="text-gray-600 mb-3">Paste the job description text below:</p>
                        <textarea 
                            id="jobDescription"
                            placeholder="Copy and paste job description here..."
                            class="w-full p-4 border border-gray-300 rounded-lg min-h-[200px] resize-vertical"
                        ></textarea>
                    </div>
                </div>
                
                <div class="mt-8 flex flex-wrap gap-4 justify-center">
                    <button id="scoreBtn" class="bg-accent hover:bg-primary text-white px-8 py-4 rounded-full font-medium text-lg flex items-center group relative z-10">
                        <span class="group-hover:scale-110 transition mr-2">
                            <i class="fas fa-chart-line"></i>
                        </span>
                        Score My Resume
                    </button>
                    
                    <button id="suggestionBtn" class="bg-primary hover:bg-accent text-white px-8 py-4 rounded-full font-medium text-lg flex items-center group relative z-10">
                        <span class="group-hover:scale-110 transition mr-2">
                            <i class="fas fa-lightbulb"></i>
                        </span>
                        Get AI Suggestions
                    </button>
                    
                    <button id="downloadBtn" class="bg-success hover:bg-green-700 text-white px-8 py-4 rounded-full font-medium text-lg flex items-center group relative z-10">
                        <span class="group-hover:scale-110 transition mr-2">
                            <i class="fas fa-download"></i>
                        </span>
                        Download Suggestions
                    </button>
                </div>
                
                <div class="mt-12" id="resultsContainer">
                    <div class="text-center mb-6">
                        <h3 class="text-2xl font-bold">Your Analysis Results</h3>
                        <p class="text-gray-600">Suggestions will appear here after analysis</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- Mobile Menu Toggle ---
            const mobileMenuBtn = document.getElementById('mobileMenuBtn');
            const mobileMenu = document.getElementById('mobileMenu');
            const mobileMenuLinks = document.querySelectorAll('.mobile-menu-link');

            mobileMenuBtn.addEventListener('click', () => {
                mobileMenu.classList.toggle('active');
                const icon = mobileMenuBtn.querySelector('i');
                icon.classList.toggle('fa-bars');
                icon.classList.toggle('fa-times');
            });

            // Close mobile menu when clicking on links
            mobileMenuLinks.forEach(link => {
                link.addEventListener('click', () => {
                    mobileMenu.classList.remove('active');
                    const icon = mobileMenuBtn.querySelector('i');
                    icon.classList.add('fa-bars');
                    icon.classList.remove('fa-times');
                });
            });

            // --- Animate cards ---
            const cards = document.querySelectorAll('.card');
            cards.forEach((card, index) => {
                card.classList.add('fade-in');
                card.style.animationDelay = `${index * 0.1}s`;
            });

            // --- File Upload ---
            const uploadArea = document.getElementById('resumeUpload');
            const fileInput = document.getElementById('resumeInput');
            const filenameDisplay = document.getElementById('resumeFilename'); 

            uploadArea.addEventListener('click', () => fileInput.click());

            const handleFileChange = (files) => {
                if (files && files[0]) {
                    const file = files[0];

                    // Check PDF type
                    if (file.type !== 'application/pdf') {
                        alert('Only PDF files are allowed.');
                        fileInput.value = '';
                        filenameDisplay.textContent = 'Drag & drop your PDF resume';
                        uploadArea.classList.remove('border-green-400');
                        return;
                    }

                    // Check max 5MB
                    if (file.size > 5 * 1024 * 1024) {
                        alert('File too large. Max 5MB allowed.');
                        fileInput.value = '';
                        filenameDisplay.textContent = 'Drag & drop your PDF resume';
                        return;
                    }

                    filenameDisplay.textContent = file.name;
                    uploadArea.classList.add('border-green-400');
                }
            };

            fileInput.addEventListener('change', (e) => handleFileChange(e.target.files));

            // Drag and drop events
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('drag-over');
            });
            
            uploadArea.addEventListener('dragleave', () => {
                uploadArea.classList.remove('drag-over');
            });
            
            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('drag-over');
                handleFileChange(e.dataTransfer.files);
            });

            // --- Buttons ---
            const scoreBtn = document.getElementById('scoreBtn');
            const suggestionBtn = document.getElementById('suggestionBtn');
            const downloadBtn = document.getElementById('downloadBtn');
            const resumeInput = document.getElementById('resumeInput');
            const jobDescription = document.getElementById('jobDescription');
            const resultsContainer = document.getElementById('resultsContainer');

            let latestSuggestions = []; // For download

            // For scoring
            scoreBtn.addEventListener('click', async () => {
                const resumeFile = resumeInput.files[0];
                const jdText = jobDescription.value.trim();

                if (!resumeFile || !jdText) {
                    alert('Please upload a resume and enter a job description.');
                    return;
                }

                const formData = new FormData();
                formData.append('resume_file', resumeFile); 
                formData.append('job_description', jdText);

                // Show a loading state
                resultsContainer.innerHTML = `
                    <div class="text-center p-8">
                        <i class="fas fa-spinner fa-spin text-4xl text-primary"></i>
                        <p class="mt-4 text-lg text-gray-600">Calculating score...</p>
                    </div>
                `;

                try {
                    const response = await fetch('http://127.0.0.1:8000/score/', { method: 'POST', body: formData });
                    if (!response.ok) {
                        throw new Error(`Failed to fetch score. Server responded with status: ${response.status}`);
                    }
                    const result = await response.json();
                    const score = parseFloat(result.match_score);

                    // Check if the score is a valid number
                    if (isNaN(score)) {
                        throw new Error('Invalid score data received from the server.');
                    }

                    // Display the score with enhanced styling
        resultsContainer.innerHTML = `
            <div class="text-center mb-6 fade-in">
                <h3 class="text-2xl font-bold">Your Resume Score</h3>
                <div class="relative inline-block mt-4">
                    <div class="w-24 h-24 rounded-full bg-gradient-to-br from-primary to-accent flex items-center justify-center pulse">
                        <span class="text-white text-4xl font-bold">${score.toFixed(2)}</span>
                    </div>
                </div>
                <p class="text-gray-600 text-lg mt-2">Match Score: <span class="font-bold text-primary">${score.toFixed(2)}</span>%</p>
            </div>
        `;
    } catch (err) {
        console.error('Fetch error:', err);
        resultsContainer.innerHTML = `<p class="text-center text-error mt-4">Error fetching score. Please try again. Details: ${err.message}</p>`;
    }
});
    //suggestion button
    suggestionBtn.addEventListener('click', async () => {
    const resumeFile = resumeInput.files[0];
    const jdText = jobDescription.value.trim();

    if (!resumeFile || !jdText) {
        alert('Please upload a resume and enter a job description.');
        return;
    }

    const formData = new FormData();
    formData.append('resume_file', resumeFile); 
    formData.append('job_description', jdText);

    // Show a loading state
    resultsContainer.innerHTML = `
        <div class="text-center p-8">
            <i class="fas fa-spinner fa-spin text-4xl text-primary"></i>
            <p class="mt-4 text-lg text-gray-600">Generating AI suggestions...</p>
        </div>
    `;

    try {
        const response = await fetch('http://127.0.0.1:8000/suggestions/', { method: 'POST', body: formData });
        if (!response.ok) {
            throw new Error(`Failed to fetch suggestions. Server responded with status: ${response.status}`);
        }
        const result = await response.json();

        // The suggestions are a single string from the backend, not an array.
        const suggestionsText = result.suggestions;

        // Store the text for download
        latestSuggestions = suggestionsText;

        resultsContainer.innerHTML = `
            <div class="text-center mb-6 fade-in">
                <h3 class="text-2xl font-bold">AI Suggestions</h3>
                <div class="mt-4 p-4 bg-gray-50 rounded-lg text-left whitespace-pre-wrap leading-relaxed shadow-inner">
                    ${suggestionsText}
                </div>
            </div>
        `;
    } catch (err) {
        console.error(err);
        resultsContainer.innerHTML = `<p class="text-center text-error mt-4">Error fetching suggestions. Please check the backend console for details.</p>`;
    }
});

    // --- Download ---
    downloadBtn.addEventListener('click', () => {
        if (!latestSuggestions.length) {
            alert('No suggestions available to download. Please generate suggestions first.');
            return;
        }

        const blob = new Blob([latestSuggestions], { type: 'text/plain' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'resume_suggestions.txt';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
    });
});
</script>
</body>
</html>